
# Прогнозирование покупок в интернет-магазине

## Описание проекта

Интернет-магазин собирает историю покупок клиентов и информацию о рекламных рассылках. Цель проекта — предсказать вероятность того, что клиент совершит покупку в течение следующих **90 дней**. Это поможет повысить эффективность маркетинговых кампаний за счёт персонализированных предложений.

## Цель

Разработка модели классификации, которая по историческим данным предсказывает вероятность покупки.

## Используемые данные

- **apparel-purchases.csv** — история покупок пользователей
- **apparel-messages.csv** — история рекламных рассылок
- **apparel-target_binary.csv** — целевой признак: была ли покупка в течение 90 дней
- **full_campaign_daily_event.csv** — агрегация общей базы рассылок по дням и типам событий

## Этапы работы

1. Предобработка данных, удаление дубликатов
2. Генерация признаков на основе истории покупок и рассылок
3. Работа с несбалансированными классами
4. Обучение и подбор модели (CatBoostClassifier, LogisticRegression, RandomForestClassifier)
5. Оптимизация по метрике recall, ROC-AUC
6. Оценка лучшей модели
7. Анализ важности признаков
8. Выводы и рекомендации

## Результаты

- **ROC-AUC**: 0.7165
- **Recall (по порогу 0.5)**: 93.75%
- **Recall (по оптимальному порогу 0.69)**: 67.19%
- Основные факторы, влияющие на покупки:
  - История откликов на кампании
  - Предпочтения в категориях товаров
  - Активность клиента

## Как использовать

1. [Скачать датасеты](https://disk.yandex.ru/d/cIfdQTAPMQ8XxA)

2. Установите зависимости:

```bash
pip install -r requirements.txt
```

3. Запустите Jupyter Notebook:

```bash
jupyter notebook
```

4. Откройте файл `Project.ipynb` и выполните ячейки.

## Используемые библиотеки

`pandas`, `numpy`, `scikit-learn`, `catboost`, `shap`, `category_encoders`, `imbalanced-learn`, `phik`, `statsmodels`, `matplotlib`, `seaborn`, `jupyterlab`

## Автор

[Филиппов Юрий Владимирович](https://github.com/Opozitto)
